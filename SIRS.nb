(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42716,        999]
NotebookOptionsPosition[     40737,        960]
NotebookOutlinePosition[     41162,        976]
CellTagsIndexPosition[     41119,        973]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["SIRS    ", "Title",
 CellFrame->{{0, 0}, {2, 0}},
 CellFrameColor->GrayLevel[0.75],
 CellChangeTimes->{{3.8626566690693207`*^9, 3.8626566839286575`*^9}, {
   3.8626567252939262`*^9, 3.862656744203694*^9}, 3.862656786166607*^9, {
   3.8628992976432743`*^9, 3.8628992980238547`*^9}, {3.862900152509416*^9, 
   3.8629001543930674`*^9}, 3.872667655220007*^9, {3.8731883466976013`*^9, 
   3.873188350991645*^9}, {3.873356771076268*^9, 3.87335677558883*^9}, {
   3.8733593651783695`*^9, 3.8733593913003063`*^9}, {3.8733598501758175`*^9, 
   3.873359857704569*^9}, 3.907553065123856*^9, {3.9078450922422233`*^9, 
   3.9078450980989676`*^9}, {3.9085242876489267`*^9, 
   3.9085242898113303`*^9}, {3.91003794845965*^9, 3.9100379488442554`*^9}, {
   3.9103980579428964`*^9, 3.9103980594431877`*^9}, {3.9288079337192745`*^9, 
   3.928807950123585*^9}, {3.928818036135414*^9, 3.9288180730987067`*^9}, {
   3.9288219761094193`*^9, 3.928821993767378*^9}, {3.93756131282218*^9, 
   3.937561326393383*^9}, {3.9384839898006806`*^9, 3.9384840092979593`*^9}, {
   3.9386793947641*^9, 
   3.9386793958818474`*^9}},ExpressionUUID->"1cb3a513-a888-4c52-a820-\
9457dc13b487"],

Cell["by   R. Adenane, F. Avram and AD.Halanay", "Author",
 CellChangeTimes->{{3.924776302601963*^9, 3.9247763040748*^9}, 
   3.924782532411165*^9, {3.9247857608129683`*^9, 3.92478576470261*^9}, {
   3.9249381184168167`*^9, 3.9249381793080673`*^9}, {3.9252951248708787`*^9, 
   3.925295127911755*^9}, {3.934932795673813*^9, 3.9349328119403734`*^9}, {
   3.9375613040399504`*^9, 3.9375613041966453`*^9}, {3.93807745746309*^9, 
   3.9380774682416162`*^9}},ExpressionUUID->"0aeee3fb-3c98-4206-b2e4-\
e6f942fa02ec"],

Cell[CellGroupData[{

Cell["CRN for  SIRS-FA:", "Section",
 CellChangeTimes->{{3.924776356652172*^9, 3.924776365471304*^9}, 
   3.924778147749792*^9, 3.92477856893644*^9, {3.924938494612618*^9, 
   3.9249385118512907`*^9}, {3.9249385787670884`*^9, 
   3.9249386080458508`*^9}, {3.9249391233611307`*^9, 3.924939125255047*^9}, {
   3.924939690637724*^9, 3.9249397180649033`*^9}, {3.9249402854712825`*^9, 
   3.9249402946319466`*^9}, {3.925295617647084*^9, 3.925295620448703*^9}, {
   3.925363810664988*^9, 3.925363818039801*^9}, {3.9288254816639557`*^9, 
   3.9288255094922714`*^9}, {3.9288263919005313`*^9, 3.928826404312552*^9}, {
   3.9288264728878703`*^9, 3.928826480746402*^9}, {3.929173772958482*^9, 
   3.9291737763922467`*^9}, {3.9371190080650043`*^9, 3.937119025484405*^9}, {
   3.937293179286101*^9, 3.9372932008287477`*^9}, {3.937299600883214*^9, 
   3.9372996048107796`*^9}, {3.937563951850091*^9, 3.9375639564133067`*^9}, {
   3.9380809917374153`*^9, 
   3.9380809982006955`*^9}},ExpressionUUID->"17d21e8d-165b-4eec-a74d-\
c68e0c2dbd89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Latex", " ", "dictionary"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "\[Gamma]r", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Gamma]", ",", "r"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "\[Mu]i", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Mu]", ",", "i"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "\[Mu]s", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Mu]", ",", "s"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "\[Mu]r", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Mu]", ",", "r"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "\[Gamma]s", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Gamma]", ",", "s"}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"Format", "[", "\[Gamma]i", "]"}], ":=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Gamma]", ",", "i"}], "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.938080973181899*^9, 3.9380809804228053`*^9}, {
   3.9380810232193117`*^9, 3.9380811439124193`*^9}, {3.9383475521305895`*^9, 
   3.9383476346513605`*^9}, {3.9383893901488323`*^9, 
   3.9383894503364906`*^9}, {3.938389494804387*^9, 3.938389591460903*^9}, {
   3.9383896558993316`*^9, 3.9383896615480585`*^9}, {3.9383897031168585`*^9, 
   3.9383897162009864`*^9}, {3.9383897792876205`*^9, 
   3.9383898014392023`*^9}, {3.9383909985413694`*^9, 3.9383910159924717`*^9}, 
   3.938403559156134*^9, {3.938405784531815*^9, 3.9384058039334803`*^9}, {
   3.938433083227205*^9, 3.938433101311104*^9}, {3.938433310896343*^9, 
   3.938433311550751*^9}, {3.938493806044052*^9, 3.938493811642812*^9}, {
   3.938515604837175*^9, 3.93851561836593*^9}, {3.938515746734848*^9, 
   3.938515750618087*^9}, {3.9385158041097174`*^9, 3.9385158422162743`*^9}, {
   3.938515903759993*^9, 3.938515905799669*^9}, {3.9385161335405807`*^9, 
   3.938516136027138*^9}, 3.9385161734756255`*^9, {3.9385166784404297`*^9, 
   3.938516680206685*^9}, {3.9385167250472555`*^9, 3.93851673717749*^9}, {
   3.938516773362447*^9, 3.938516774256384*^9}, 3.938516874060058*^9, {
   3.9385204859504967`*^9, 3.9385205214532037`*^9}, {3.9385350281350036`*^9, 
   3.9385350563872323`*^9}, {3.9385350964044094`*^9, 3.938535098121909*^9}, {
   3.9385355375981917`*^9, 3.938535538181195*^9}, {3.9385355924345355`*^9, 
   3.9385356162957287`*^9}, {3.9386915423225284`*^9, 3.938691544168605*^9}, {
   3.938691578314967*^9, 3.938691603689057*^9}, {3.939116571931388*^9, 
   3.939116584823573*^9}, {3.9403212682229276`*^9, 3.9403212950603895`*^9}, {
   3.941858330235405*^9, 3.941858338809578*^9}, {3.9418584400384827`*^9, 
   3.941858440850377*^9}, {3.94185851892631*^9, 3.941858575670474*^9}, {
   3.9418586428020067`*^9, 3.941858689723423*^9}, {3.9418615022507887`*^9, 
   3.941861556947872*^9}, {3.9421263941619835`*^9, 3.9421264103545218`*^9}, {
   3.942126451227109*^9, 3.9421264768339643`*^9}, {3.9421267558483267`*^9, 
   3.942126758912133*^9}, {3.94212681251989*^9, 3.942126941421763*^9}, {
   3.9421269933433685`*^9, 3.94212699854296*^9}, {3.942127064611761*^9, 
   3.9421270849338555`*^9}, {3.942127123377571*^9, 3.9421271443025026`*^9}, {
   3.9421272567544355`*^9, 3.942127266976624*^9}, {3.9423181698830643`*^9, 
   3.9423182042970223`*^9}, {3.9423182497945094`*^9, 3.942318321322199*^9}, {
   3.942318377032875*^9, 3.942318423316808*^9}, {3.942318479257777*^9, 
   3.94231852589826*^9}, {3.942318562277784*^9, 3.9423185728082137`*^9}, {
   3.9423186884854946`*^9, 3.942318700444003*^9}, {3.942318750906472*^9, 
   3.9423188286637435`*^9}, {3.9423191272493744`*^9, 3.942319206414092*^9}, {
   3.9424085624090967`*^9, 3.942408571861703*^9}, {3.9424086514929996`*^9, 
   3.942408668280349*^9}, {3.942408709997853*^9, 3.9424087163245764`*^9}, {
   3.9424099251470456`*^9, 3.942409973139344*^9}, {3.942410012556161*^9, 
   3.9424100231578856`*^9}, {3.9424100633588676`*^9, 3.942410084710431*^9}, {
   3.942410175564289*^9, 3.9424101976239185`*^9}, {3.942410232703663*^9, 
   3.942410304575947*^9}, {3.94241035940314*^9, 3.942410417198542*^9}, {
   3.942892963735295*^9, 3.942893017200353*^9}, 3.9428930899494047`*^9, {
   3.94289314127392*^9, 3.9428931453142242`*^9}, {3.942893185853241*^9, 
   3.942893206208748*^9}, 3.9428939926843553`*^9, {3.942894364477736*^9, 
   3.9428945223514757`*^9}, {3.9493061405447755`*^9, 
   3.9493061638849564`*^9}, {3.9535039972975082`*^9, 
   3.9535040048005877`*^9}, {3.9535040553371234`*^9, 3.953504120954658*^9}, {
   3.953504152422942*^9, 3.9535041938426695`*^9}, {3.9535042633778067`*^9, 
   3.953504344988617*^9}, 3.9535044395240774`*^9, {3.9535044920594544`*^9, 
   3.9535045881810837`*^9}, {3.953504641759637*^9, 3.953504724272917*^9}, 
   3.953504833529956*^9, {3.953504877681926*^9, 3.9535051405238495`*^9}, {
   3.953505221751789*^9, 3.9535052317688866`*^9}, {3.9535052767774086`*^9, 
   3.9535052925722303`*^9}, {3.9535053408254967`*^9, 
   3.9535053465919065`*^9}, {3.953505476515848*^9, 3.953505688579363*^9}, {
   3.953505781133531*^9, 3.9535058252858353`*^9}, {3.953506679201748*^9, 
   3.953506697619494*^9}, {3.9535227040486383`*^9, 
   3.95352276576619*^9}},ExpressionUUID->"e8bfe20d-0a36-4a7a-9082-\
bf6d2ecb6de7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"\"\<Global\[OpenCurlyQuote]*\>\"", ",", "s", ",", "i", ",", "r"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"SetOptions", "[", 
   RowBox[{"$FrontEndSession", ",", " ", 
    RowBox[{"NotebookAutoSave", " ", "->", " ", "True"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookSave", "[", "]"}], ";", 
   RowBox[{"AppendTo", "[", 
    RowBox[{
    "$Path", ",", "\"\<C:\\\\Users\\\\flori\\\\Dropbox\\\\Codes\>\""}], "]"}],
    ";", 
   RowBox[{"<<", "EpidCRN`"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "input", " ", "model", " ", "using", " ", "ReactionKinetics", " ", 
    "structure"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<ReactionKinetics`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Summary", "  ", "of", " ", "some", " ", "key", " ", "formulas"}],
     ",", " ", 
    RowBox[{"to", " ", "ve", " ", "rederived", " ", "later"}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sd", "=", 
    FractionBox[
     RowBox[{"\[Lambda]", " ", 
      RowBox[{"(", 
       RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}]}], 
     RowBox[{
      RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}], " ", "\[Mu]s"}]}]]}], 
   ";", 
   RowBox[{"mR", "=", 
    RowBox[{"\[Beta]", "/", 
     RowBox[{"(", 
      RowBox[{"\[Mu]i", "+", "\[Gamma]i"}], ")"}]}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "particular", " ", "cases", " ", "and", " ", "reparametrization", " ", 
    "conditions"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"cmu", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Mu]r", "->", "\[Mu]"}], ",", 
     RowBox[{"\[Mu]s", "->", "\[Mu]"}], ",", 
     RowBox[{"\[Lambda]", "->", "\[Mu]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cbe", "=", 
    RowBox[{"\[Beta]", "->", 
     RowBox[{"R", 
      RowBox[{"(", 
       RowBox[{"\[Mu]i", "+", "\[Gamma]i"}], ")"}]}]}]}], ";", 
   RowBox[{"cR", "=", 
    RowBox[{"R", "->", 
     RowBox[{"R0", "/", "sd"}]}]}], ";"}], "\n", 
  RowBox[{"(*", "inputs", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"RN", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<0\>\"", "\[Rule]", "\"\<S\>\""}], ",", 
     RowBox[{
      RowBox[{"\"\<S\>\"", "+", "\"\<I\>\""}], "\[Rule]", 
      RowBox[{"2", " ", "\"\<I\>\""}]}], ",", 
     RowBox[{"\"\<I\>\"", "->", "\"\<R\>\""}], ",", 
     RowBox[{"\"\<R\>\"", "->", "\"\<S\>\""}], ",", 
     RowBox[{"\"\<S\>\"", "->", "\"\<R\>\""}], ",", 
     RowBox[{"\"\<S\>\"", "->", "\"\<0\>\""}], ",", 
     RowBox[{"\"\<I\>\"", "->", "\"\<0\>\""}], ",", 
     RowBox[{"\"\<R\>\"", "->", "\"\<0\>\""}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"{", 
    RowBox[{"s", ",", "i", ",", "r"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"par", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Lambda]", ",", "\[Beta]", ",", "\[Gamma]i", ",", " ", "\[Gamma]r", ",",
      "\[Gamma]s", ",", " ", "\[Mu]s", ",", " ", "\[Mu]i", ",", "\[Mu]r"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cp", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{"par", ">", "0"}], "]"}]}], ";", 
   RowBox[{"cv", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{"var", ">=", "0"}], "]"}]}], ";", 
   RowBox[{"ct", "=", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"cp", ",", "cv"}], "]"}], ",", 
      RowBox[{"R", ">", "0"}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{"Universal", " ", "notebook", " ", "starts"}], "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"RND", "=", 
   RowBox[{"ReactionsData", "[", "RN", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]", "=", " ", 
    RowBox[{
     RowBox[{"RND", "[", "\"\<\[Gamma]\>\"", "]"}], "//", "Normal"}]}], ";"}],
   "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "comp", ",", "reac", ",", "nR", ",", "spec", ",", "nS", ",", "vol", ",", 
     "vars", ",", "defi"}], "}"}], "=", 
   RowBox[{"RND", "[", 
    RowBox[{
    "\"\<complexes\>\"", ",", "\"\<reactionsteps\>\"", ",", "\"\<R\>\"", ",", 
     "\"\<species\>\"", ",", "\"\<M\>\"", ",", "\"\<volpertgraph\>\"", ",", 
     "\n", "\"\<variables\>\"", ",", "\"\<deficiency\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Stoichio mat \[CapitalGamma]=\>\"", ",", 
    RowBox[{"\[CapitalGamma]", "//", "MatrixForm"}], ",", " ", 
    "\"\< has rank \>\"", ",", 
    RowBox[{"MatrixRank", "[", "\[CapitalGamma]", "]"}], ",", 
    "\"\< and deficiency \>\"", ",", " ", 
    RowBox[{"RND", "[", "\"\<deficiency\>\"", "]"}], ",", 
    "\"\< constants\nare \>\"", ",", "par"}], "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"RND", "[", "\"\<variables\>\"", "]"}], "//", "Length"}], ",", 
   "\"\< variables=\>\"", ",", 
   RowBox[{"RND", "[", "\"\<variables\>\"", "]"}], ",", "\"\<=\>\"", ",", 
   "var"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expo", "=", " ", 
   RowBox[{
    RowBox[{"RND", "[", "\"\<\[Alpha]\>\"", "]"}], "//", "Normal"}]}], ";", 
  RowBox[{"expo", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prod", "=", " ", 
   RowBox[{
    RowBox[{"RND", "[", "\"\<\[Beta]\>\"", "]"}], "//", "Normal"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"rv", "=", 
   RowBox[{"expM", "[", 
    RowBox[{"var", ",", 
     RowBox[{"(", 
      RowBox[{"expo", "//", "Transpose"}], ")"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Rv", "=", 
   RowBox[{"par", "*", "rv"}]}], ";", 
  RowBox[{"RHS", "=", 
   RowBox[{"\[CapitalGamma]", ".", "Rv"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "i"}], " ", "s", " ", "\[Beta]"}], "+", 
      RowBox[{"r", " ", "\[Gamma]r"}], "-", 
      RowBox[{"s", " ", "\[Gamma]s"}], "+", "\[Lambda]", "-", 
      RowBox[{"s", " ", "\[Mu]s"}]}], ",", 
     RowBox[{
      RowBox[{"i", " ", "s", " ", "\[Beta]"}], "-", 
      RowBox[{"i", " ", "\[Gamma]i"}], "-", 
      RowBox[{"i", " ", "\[Mu]i"}]}], ",", 
     RowBox[{
      RowBox[{"i", " ", "\[Gamma]i"}], "-", 
      RowBox[{"r", " ", "\[Gamma]r"}], "+", 
      RowBox[{"s", " ", "\[Gamma]s"}], "-", 
      RowBox[{"r", " ", "\[Mu]r"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"jac", "=", 
   RowBox[{"Grad", "[", 
    RowBox[{"RHS", ",", "var"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"so", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"RHS", "==", "0"}], "]"}], ",", "var"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<RHS is \>\"", ",", "RHS", ",", "\"\<=\>\"", ",", 
   RowBox[{"RHS", "//", "MatrixForm"}], ",", "\"\< fixed pts are\>\""}], 
  "]"}], "\n", 
 RowBox[{"so", "//", "FullSimplify"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "check", " ", "positivity", " ", "of", " ", "endemic", " ", "solution"}], 
   "*)"}], 
  RowBox[{
   RowBox[{"inf", "=", 
    RowBox[{"{", "2", "}"}]}], ";", 
   RowBox[{"vx", "=", 
    RowBox[{"var", "[", 
     RowBox[{"[", "inf", "]"}], "]"}]}], ";", 
   RowBox[{"inp", "=", 
    RowBox[{"{", "1", "}"}]}], ";", 
   RowBox[{"vy", "=", 
    RowBox[{"var", "[", 
     RowBox[{"[", "inp", "]"}], "]"}]}], ";", 
   RowBox[{"vNy", "=", 
    RowBox[{"Complement", "[", 
     RowBox[{"var", ",", "vy"}], "]"}]}], ";"}]}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<endemic pt pos when \>\"", ",", 
   RowBox[{"cvNy", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Reduce", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vNy", "/.", 
            RowBox[{"so", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "/.", "cbe"}], ")"}], ">", 
         "0"}], "]"}], "]"}], ",", "ct"}], "]"}]}], ",", "\n", 
   "\"\< and R>1  starting from\>\""}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Rc", "=", 
   RowBox[{
    RowBox[{"cvNy", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", "\[Lambda]"}]}], ";", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Reduce", "[", 
     RowBox[{"Rc", ">", "1"}], "]"}], ",", "ct"}], "]"}]}], "\n", 
 RowBox[{"Print", "[", 
  "\"\<Check: when mus=mur=mu, this becomes R0>1 or R>1/sd=\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Rc", "/.", "cmu"}], "//", "Simplify"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Stability", " ", "of", " ", "DFE"}], ",", " ", 
    RowBox[{"using", " ", "NGM", " ", "script"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"mod", "=", 
   RowBox[{"{", 
    RowBox[{"RHS", ",", "var", ",", "par"}], 
    StyleBox["}",
     FontSize->14]}]}], 
  StyleBox[";",
   FontSize->14]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jacI", "=", 
    RowBox[{"Grad", "[", 
     RowBox[{
      RowBox[{"RHS", "[", 
       RowBox[{"[", "inf", "]"}], "]"}], ",", 
      RowBox[{"var", "[", 
       RowBox[{"[", "inf", "]"}], "]"}]}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"ng", "=", 
   RowBox[{"NGM", "[", 
    RowBox[{"mod", ",", "inf"}], "]"}]}], ";", 
  RowBox[{"K", "=", 
   RowBox[{"ng", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";", 
  RowBox[{"M", "=", 
   RowBox[{"ng", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Tm", "=", 
   RowBox[{"ng", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"ng", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<M is\>\"", ",", 
   RowBox[{"M", "//", "MatrixForm"}], ",", " ", "\"\< and K=\>\"", ",", 
   RowBox[{"K", "//", "MatrixForm"}], ",", "\"\< has eig\>\"", ",", 
   RowBox[{"eig", "=", 
    RowBox[{"K", "//", "Eigenvalues"}]}]}], "]"}], "\n", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<R0=\>\"", ",", 
   RowBox[{"R0", "=", 
    RowBox[{"eig", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "Code",
 CellChangeTimes->{{3.938080973181899*^9, 3.9380809804228053`*^9}, {
   3.9380810232193117`*^9, 3.9380811439124193`*^9}, {3.9383475521305895`*^9, 
   3.9383476346513605`*^9}, {3.9383893901488323`*^9, 
   3.9383894503364906`*^9}, {3.938389494804387*^9, 3.938389591460903*^9}, {
   3.9383896558993316`*^9, 3.9383896615480585`*^9}, {3.9383897031168585`*^9, 
   3.9383897162009864`*^9}, {3.9383897792876205`*^9, 
   3.9383898014392023`*^9}, {3.9383909985413694`*^9, 3.9383910159924717`*^9}, 
   3.938403559156134*^9, {3.938405784531815*^9, 3.9384058039334803`*^9}, {
   3.938433083227205*^9, 3.938433101311104*^9}, {3.938433310896343*^9, 
   3.938433311550751*^9}, {3.938493806044052*^9, 3.938493811642812*^9}, {
   3.938515604837175*^9, 3.93851561836593*^9}, {3.938515746734848*^9, 
   3.938515750618087*^9}, {3.9385158041097174`*^9, 3.9385158422162743`*^9}, {
   3.938515903759993*^9, 3.938515905799669*^9}, {3.9385161335405807`*^9, 
   3.938516136027138*^9}, 3.9385161734756255`*^9, {3.9385166784404297`*^9, 
   3.938516680206685*^9}, {3.9385167250472555`*^9, 3.93851673717749*^9}, {
   3.938516773362447*^9, 3.938516774256384*^9}, 3.938516874060058*^9, {
   3.9385204859504967`*^9, 3.9385205214532037`*^9}, {3.9385350281350036`*^9, 
   3.9385350563872323`*^9}, {3.9385350964044094`*^9, 3.938535098121909*^9}, {
   3.9385355375981917`*^9, 3.938535538181195*^9}, {3.9385355924345355`*^9, 
   3.9385356162957287`*^9}, {3.9386915423225284`*^9, 3.938691544168605*^9}, {
   3.938691578314967*^9, 3.938691603689057*^9}, {3.939116571931388*^9, 
   3.939116584823573*^9}, {3.9403212682229276`*^9, 3.9403212950603895`*^9}, {
   3.941858330235405*^9, 3.941858338809578*^9}, {3.9418584400384827`*^9, 
   3.941858440850377*^9}, {3.94185851892631*^9, 3.941858575670474*^9}, {
   3.9418586428020067`*^9, 3.941858689723423*^9}, {3.9418615022507887`*^9, 
   3.941861556947872*^9}, {3.9421263941619835`*^9, 3.9421264103545218`*^9}, {
   3.942126451227109*^9, 3.9421264768339643`*^9}, {3.9421267558483267`*^9, 
   3.942126758912133*^9}, {3.94212681251989*^9, 3.942126941421763*^9}, {
   3.9421269933433685`*^9, 3.94212699854296*^9}, {3.942127064611761*^9, 
   3.9421270849338555`*^9}, {3.942127123377571*^9, 3.9421271443025026`*^9}, {
   3.9421272567544355`*^9, 3.942127266976624*^9}, {3.9423181698830643`*^9, 
   3.9423182042970223`*^9}, {3.9423182497945094`*^9, 3.942318321322199*^9}, {
   3.942318377032875*^9, 3.942318423316808*^9}, {3.942318479257777*^9, 
   3.94231852589826*^9}, {3.942318562277784*^9, 3.9423185728082137`*^9}, {
   3.9423186884854946`*^9, 3.942318700444003*^9}, {3.942318750906472*^9, 
   3.9423188286637435`*^9}, {3.9423191272493744`*^9, 3.942319206414092*^9}, {
   3.9424085624090967`*^9, 3.942408571861703*^9}, {3.9424086514929996`*^9, 
   3.942408668280349*^9}, {3.942408709997853*^9, 3.9424087163245764`*^9}, {
   3.9424099251470456`*^9, 3.942409973139344*^9}, {3.942410012556161*^9, 
   3.9424100231578856`*^9}, {3.9424100633588676`*^9, 3.942410084710431*^9}, {
   3.942410175564289*^9, 3.9424101976239185`*^9}, {3.942410232703663*^9, 
   3.942410304575947*^9}, {3.94241035940314*^9, 3.942410417198542*^9}, {
   3.942892963735295*^9, 3.942893017200353*^9}, 3.9428930899494047`*^9, {
   3.94289314127392*^9, 3.9428931453142242`*^9}, {3.942893185853241*^9, 
   3.942893206208748*^9}, 3.9428939926843553`*^9, {3.942894364477736*^9, 
   3.9428945223514757`*^9}, {3.9493061405447755`*^9, 
   3.9493061638849564`*^9}, {3.9535039972975082`*^9, 
   3.9535040048005877`*^9}, {3.9535040553371234`*^9, 3.953504120954658*^9}, {
   3.953504152422942*^9, 3.9535041938426695`*^9}, {3.9535042633778067`*^9, 
   3.953504344988617*^9}, 3.9535044395240774`*^9, {3.9535044920594544`*^9, 
   3.9535045881810837`*^9}, {3.953504641759637*^9, 3.953504724272917*^9}, 
   3.953504833529956*^9, {3.953504877681926*^9, 3.9535051405238495`*^9}, {
   3.953505221751789*^9, 3.9535052317688866`*^9}, {3.9535052767774086`*^9, 
   3.9535052925722303`*^9}, {3.9535053408254967`*^9, 
   3.9535053465919065`*^9}, {3.953505476515848*^9, 3.953505688579363*^9}, {
   3.953505781133531*^9, 3.9535058252858353`*^9}, {3.953506679201748*^9, 
   3.953506697619494*^9}, {3.9535227040486383`*^9, 3.95352279924477*^9}, 
   3.9535228658823566`*^9, {3.95352294188204*^9, 3.953523000407156*^9}, {
   3.9535230402054944`*^9, 3.9535230748871975`*^9}, 3.953781431360549*^9, {
   3.954118911537979*^9, 3.9541189335396547`*^9}, {3.954118970983629*^9, 
   3.9541189744219174`*^9}, {3.954119007809229*^9, 3.9541190182607293`*^9}, 
   3.9541190673126235`*^9, {3.9541191007430573`*^9, 3.9541191134596634`*^9}, {
   3.9541191462066927`*^9, 3.954119150419109*^9}, {3.9541376473579397`*^9, 
   3.954137655755117*^9}},
 CellLabel->
  "In[2257]:=",ExpressionUUID->"e2f62f23-3e1a-4488-b607-16e0bfefb1ec"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Stoichio mat \[CapitalGamma]=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", 
        RowBox[{"-", "1"}], "0", "1", 
        RowBox[{"-", "1"}], 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "1", 
        RowBox[{"-", "1"}], "0", "0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "1", 
        RowBox[{"-", "1"}], "1", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" has rank \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\" and deficiency \"\>", 
   "\[InvisibleSpace]", "\<\"\[Delta]=N-L-S=6-2-3=1\"\>", 
   "\[InvisibleSpace]", "\<\" constants\\nare \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Lambda]", ",", "\[Beta]", ",", "\[Gamma]i", ",", "\[Gamma]r", ",", 
     "\[Gamma]s", ",", "\[Mu]s", ",", "\[Mu]i", ",", "\[Mu]r"}], "}"}]}],
  SequenceForm["Stoichio mat \[CapitalGamma]=", 
   MatrixForm[{{1, -1, 0, 1, -1, -1, 0, 0}, {0, 1, -1, 0, 0, 0, -1, 0}, {0, 0,
     1, -1, 1, 0, 0, -1}}], " has rank ", 3, " and deficiency ", 
   "\[Delta]=N-L-S=6-2-3=1", 
   " constants\nare ", {$CellContext`\[Lambda], $CellContext`\[Beta], \
$CellContext`\[Gamma]i, $CellContext`\[Gamma]r, $CellContext`\[Gamma]s, \
$CellContext`\[Mu]s, $CellContext`\[Mu]i, $CellContext`\[Mu]r}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.9541376643527985`*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"5afdda0c-4e05-4854-93a3-da9293c192b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "3", "\[InvisibleSpace]", "\<\" variables=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["c", "\<\"S\"\>"], ",", 
     SubscriptBox["c", "\<\"I\"\>"], ",", 
     SubscriptBox["c", "\<\"R\"\>"]}], "}"}], 
   "\[InvisibleSpace]", "\<\"=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"s", ",", "i", ",", "r"}], "}"}]}],
  SequenceForm[3, " variables=", {
    Subscript[$CellContext`c, "S"], 
    Subscript[$CellContext`c, "I"], 
    Subscript[$CellContext`c, "R"]}, 
   "=", {$CellContext`s, $CellContext`i, $CellContext`r}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.954137664386663*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"121af67f-ba84-46e7-a1cc-b548f2243d6f"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "1", "1", "0", "0"},
     {"0", "1", "1", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9535056913473053`*^9, {3.953505813842763*^9, 3.953505826864505*^9}, 
   3.953506699146505*^9, 3.953522706719118*^9, 3.9535228072547135`*^9, 
   3.9535230199550004`*^9, 3.9535230774378204`*^9, 3.95411893827452*^9, 
   3.954118975387287*^9, 3.9541190199204965`*^9, 3.9541191167516356`*^9, 
   3.954119152473158*^9, 3.9541374693417015`*^9, 3.9541376644452715`*^9},
 CellLabel->
  "Out[2273]//MatrixForm=",ExpressionUUID->"2eecb6f4-c79a-49aa-adf0-\
91d205ed31a5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"RHS is \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "i"}], " ", "s", " ", "\[Beta]"}], "+", 
      RowBox[{"r", " ", "\[Gamma]r"}], "-", 
      RowBox[{"s", " ", "\[Gamma]s"}], "+", "\[Lambda]", "-", 
      RowBox[{"s", " ", "\[Mu]s"}]}], ",", 
     RowBox[{
      RowBox[{"i", " ", "s", " ", "\[Beta]"}], "-", 
      RowBox[{"i", " ", "\[Gamma]i"}], "-", 
      RowBox[{"i", " ", "\[Mu]i"}]}], ",", 
     RowBox[{
      RowBox[{"i", " ", "\[Gamma]i"}], "-", 
      RowBox[{"r", " ", "\[Gamma]r"}], "+", 
      RowBox[{"s", " ", "\[Gamma]s"}], "-", 
      RowBox[{"r", " ", "\[Mu]r"}]}]}], "}"}], 
   "\[InvisibleSpace]", "\<\"=\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", "i"}], " ", "s", " ", "\[Beta]"}], "+", 
          RowBox[{"r", " ", "\[Gamma]r"}], "-", 
          RowBox[{"s", " ", "\[Gamma]s"}], "+", "\[Lambda]", "-", 
          RowBox[{"s", " ", "\[Mu]s"}]}]},
        {
         RowBox[{
          RowBox[{"i", " ", "s", " ", "\[Beta]"}], "-", 
          RowBox[{"i", " ", "\[Gamma]i"}], "-", 
          RowBox[{"i", " ", "\[Mu]i"}]}]},
        {
         RowBox[{
          RowBox[{"i", " ", "\[Gamma]i"}], "-", 
          RowBox[{"r", " ", "\[Gamma]r"}], "+", 
          RowBox[{"s", " ", "\[Gamma]s"}], "-", 
          RowBox[{"r", " ", "\[Mu]r"}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" fixed pts are\"\>"}],
  SequenceForm[
  "RHS is ", {-$CellContext`i $CellContext`s $CellContext`\[Beta] + \
$CellContext`r $CellContext`\[Gamma]r - $CellContext`s $CellContext`\[Gamma]s + \
$CellContext`\[Lambda] - $CellContext`s $CellContext`\[Mu]s, $CellContext`i \
$CellContext`s $CellContext`\[Beta] - $CellContext`i $CellContext`\[Gamma]i - \
$CellContext`i $CellContext`\[Mu]i, $CellContext`i $CellContext`\[Gamma]i - \
$CellContext`r $CellContext`\[Gamma]r + $CellContext`s $CellContext`\[Gamma]s - \
$CellContext`r $CellContext`\[Mu]r}, "=", 
   MatrixForm[{-$CellContext`i $CellContext`s $CellContext`\[Beta] + \
$CellContext`r $CellContext`\[Gamma]r - $CellContext`s $CellContext`\[Gamma]s + \
$CellContext`\[Lambda] - $CellContext`s $CellContext`\[Mu]s, $CellContext`i \
$CellContext`s $CellContext`\[Beta] - $CellContext`i $CellContext`\[Gamma]i - \
$CellContext`i $CellContext`\[Mu]i, $CellContext`i $CellContext`\[Gamma]i - \
$CellContext`r $CellContext`\[Gamma]r + $CellContext`s $CellContext`\[Gamma]s - \
$CellContext`r $CellContext`\[Mu]r}], " fixed pts are"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.954137664499482*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"3a392f94-ca1b-443d-894f-8a5b61c42562"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Gamma]i", "+", "\[Mu]i"}], "\[Beta]"]}], ",", 
     RowBox[{"i", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]i", "+", "\[Mu]i"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}], " ", "\[Mu]s"}]}], 
          ")"}]}]}], 
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Gamma]r", " ", "\[Mu]i"}], "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]i", "+", "\[Mu]i"}], ")"}], " ", "\[Mu]r"}]}]]}], 
     ",", 
     RowBox[{"r", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Gamma]i", " ", "\[Lambda]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]i", "+", "\[Mu]i"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "\[Gamma]s"}], " ", "\[Mu]i"}], "+", 
           RowBox[{"\[Gamma]i", " ", "\[Mu]s"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Gamma]r", " ", "\[Mu]i"}], "+", 
        RowBox[{"\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Gamma]i", "+", "\[Mu]i"}], ")"}], " ", "\[Mu]r"}]}]]}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}]}], 
       RowBox[{
        RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}], " ", "\[Mu]s"}]}]]}], 
     ",", 
     RowBox[{"i", "\[Rule]", "0"}], ",", 
     RowBox[{"r", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Gamma]s", " ", "\[Lambda]"}], 
       RowBox[{
        RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}], " ", "\[Mu]s"}]}]]}]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9535056913473053`*^9, {3.953505813842763*^9, 3.953505826864505*^9}, 
   3.953506699146505*^9, 3.953522706719118*^9, 3.9535228072547135`*^9, 
   3.9535230199550004`*^9, 3.9535230774378204`*^9, 3.95411893827452*^9, 
   3.954118975387287*^9, 3.9541190199204965`*^9, 3.9541191167516356`*^9, 
   3.954119152473158*^9, 3.9541374693417015`*^9, 3.9541376645708413`*^9},
 CellLabel->
  "Out[2281]=",ExpressionUUID->"f6ce59fa-1605-4f07-b3e8-693345ab5165"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"endemic pt pos when \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], 
      RowBox[{"\[Gamma]r", "+", "\[Mu]r"}]], "+", "\[Mu]s"}], "<", 
    RowBox[{"R", " ", "\[Lambda]"}]}], 
   "\[InvisibleSpace]", "\<\" and R>1  starting from\"\>"}],
  SequenceForm[
  "endemic pt pos when ", $CellContext`\[Gamma]s \
$CellContext`\[Mu]r/($CellContext`\[Gamma]r + $CellContext`\[Mu]r) + \
$CellContext`\[Mu]s < $CellContext`R $CellContext`\[Lambda], 
   " and R>1  starting from"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.954137665278517*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"e7e500ea-ef90-4600-a8c7-af4740f76710"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]s", " ", "\[Mu]r"}], ">", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Gamma]r", "+", "\[Mu]r"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"\[Lambda]", "-", "\[Mu]s"}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.9535056913473053`*^9, {3.953505813842763*^9, 3.953505826864505*^9}, 
   3.953506699146505*^9, 3.953522706719118*^9, 3.9535228072547135`*^9, 
   3.9535230199550004`*^9, 3.9535230774378204`*^9, 3.95411893827452*^9, 
   3.954118975387287*^9, 3.9541190199204965`*^9, 3.9541191167516356`*^9, 
   3.954119152473158*^9, 3.9541374693417015`*^9, 3.9541376653111596`*^9},
 CellLabel->
  "Out[2284]=",ExpressionUUID->"672e6395-94b4-4c28-89cd-c2b24b4a5a46"],

Cell[BoxData["\<\"Check: when mus=mur=mu, this becomes R0>1 or R>1/sd=\"\>"], \
"Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.9541376653616066`*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"9bd6d978-7942-4799-aa62-3e7e1463c417"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Gamma]r", "+", "\[Gamma]s", "+", "\[Mu]"}], 
  RowBox[{"\[Gamma]r", "+", "\[Mu]"}]]], "Output",
 CellChangeTimes->{
  3.9535056913473053`*^9, {3.953505813842763*^9, 3.953505826864505*^9}, 
   3.953506699146505*^9, 3.953522706719118*^9, 3.9535228072547135`*^9, 
   3.9535230199550004`*^9, 3.9535230774378204`*^9, 3.95411893827452*^9, 
   3.954118975387287*^9, 3.9541190199204965`*^9, 3.9541191167516356`*^9, 
   3.954119152473158*^9, 3.9541374693417015`*^9, 3.954137665406434*^9},
 CellLabel->
  "Out[2286]=",ExpressionUUID->"7abb68fc-57ac-4989-b562-dd13f95d1831"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"M is\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"s", " ", "\[Beta]"}], "-", "\[Gamma]i", "-", "\[Mu]i"}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" and K=\"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{"s", " ", "\[Beta]"}], 
         RowBox[{"\[Gamma]i", "+", "\[Mu]i"}]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" has eig\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{"s", " ", "\[Beta]"}], 
     RowBox[{"\[Gamma]i", "+", "\[Mu]i"}]], "}"}]}],
  SequenceForm["M is", 
   MatrixForm[{{$CellContext`s $CellContext`\[Beta] - $CellContext`\[Gamma]i - \
$CellContext`\[Mu]i}}], " and K=", 
   MatrixForm[{{$CellContext`s $CellContext`\[Beta]/($CellContext`\[Gamma]i + \
$CellContext`\[Mu]i)}}], 
   " has eig", {$CellContext`s $CellContext`\[Beta]/($CellContext`\[Gamma]i + \
$CellContext`\[Mu]i)}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.954137665455372*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"88f2a5e0-b0c4-4644-9869-a7d0d73a155f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"R0=\"\>", "\[InvisibleSpace]", 
   FractionBox[
    RowBox[{"s", " ", "\[Beta]"}], 
    RowBox[{"\[Gamma]i", "+", "\[Mu]i"}]]}],
  SequenceForm[
  "R0=", $CellContext`s $CellContext`\[Beta]/($CellContext`\[Gamma]i + \
$CellContext`\[Mu]i)],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9535056909793687`*^9, {3.953505813468568*^9, 3.9535058265404673`*^9}, 
   3.953506698798374*^9, 3.953522706473624*^9, 3.9535228064994516`*^9, 
   3.953523019857565*^9, 3.953523077356971*^9, 3.9541189381828256`*^9, 
   3.954118975287936*^9, 3.954119019803788*^9, 3.9541191165105553`*^9, 
   3.9541191522021*^9, 3.9541374692092743`*^9, 3.954137665501771*^9},
 CellLabel->
  "During evaluation of \
In[2257]:=",ExpressionUUID->"a0eacc93-5d4d-4f37-ba83-b9bd2f0e9f88"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{812.5714285714286, 384.85714285714283`},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c2db0963-b9fc-4bf1-94a9-1fbdf7886aae"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1157, 18, 108, "Title",ExpressionUUID->"1cb3a513-a888-4c52-a820-9457dc13b487"],
Cell[1740, 42, 511, 7, 31, "Author",ExpressionUUID->"0aeee3fb-3c98-4206-b2e4-e6f942fa02ec"],
Cell[CellGroupData[{
Cell[2276, 53, 1026, 15, 67, "Section",ExpressionUUID->"17d21e8d-165b-4eec-a74d-c68e0c2dbd89"],
Cell[3305, 70, 5297, 89, 86, "Code",ExpressionUUID->"e8bfe20d-0a36-4a7a-9082-bf6d2ecb6de7"],
Cell[CellGroupData[{
Cell[8627, 163, 14984, 372, 932, "Code",ExpressionUUID->"e2f62f23-3e1a-4488-b607-16e0bfefb1ec"],
Cell[CellGroupData[{
Cell[23636, 539, 2262, 49, 72, "Print",ExpressionUUID->"5afdda0c-4e05-4854-93a3-da9293c192b4"],
Cell[25901, 590, 1128, 26, 22, "Print",ExpressionUUID->"121af67f-ba84-46e7-a1cc-b548f2243d6f"]
}, Open  ]],
Cell[27044, 619, 1073, 25, 78, "Output",ExpressionUUID->"2eecb6f4-c79a-49aa-adf0-91d205ed31a5"],
Cell[28120, 646, 3560, 78, 72, "Print",ExpressionUUID->"3a392f94-ca1b-443d-894f-8a5b61c42562"],
Cell[31683, 726, 2838, 78, 105, "Output",ExpressionUUID->"f6ce59fa-1605-4f07-b3e8-693345ab5165"],
Cell[34524, 806, 1103, 24, 38, "Print",ExpressionUUID->"e7e500ea-ef90-4600-a8c7-af4740f76710"],
Cell[35630, 832, 703, 15, 46, "Output",ExpressionUUID->"672e6395-94b4-4c28-89cd-c2b24b4a5a46"],
Cell[36336, 849, 578, 10, 22, "Print",ExpressionUUID->"9bd6d978-7942-4799-aa62-3e7e1463c417"],
Cell[36917, 861, 604, 11, 62, "Output",ExpressionUUID->"7abb68fc-57ac-4989-b562-dd13f95d1831"],
Cell[CellGroupData[{
Cell[37546, 876, 2329, 58, 39, "Print",ExpressionUUID->"88f2a5e0-b0c4-4644-9869-a7d0d73a155f"],
Cell[39878, 936, 807, 18, 39, "Print",ExpressionUUID->"a0eacc93-5d4d-4f37-ba83-b9bd2f0e9f88"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

